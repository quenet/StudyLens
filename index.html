<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>StudyLens AI</title>

<script src="https://unpkg.com/tesseract.js@4.0.2/dist/tesseract.min.js"></script>

<style>
:root {
    --nav-height: 72px;
    --primary: #4c51bf;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html, body {
    height: 100%;
    overflow-y: auto;
    font-family: -apple-system, BlinkMacSystemFont, 'Noto Sans KR', sans-serif;
    background: #eef1f7;
}

/* ===== HEADER ===== */
header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: var(--nav-height);
    background: #fff;
    z-index: 10000;
    box-shadow: 0 4px 14px rgba(0,0,0,0.15);
}

nav {
    display: flex;
    height: 100%;
}

nav button {
    flex: 1;
    border: none;
    background: var(--primary);
    color: #fff;
    font-weight: 600;
    font-size: 14px;
}

/* ===== MAIN ===== */
main {
    padding-top: calc(var(--nav-height) + 16px);
    padding-bottom: 40px;
}

/* ===== SECTION ===== */
.section {
    display: none;
    background: #fff;
    margin: 16px;
    padding: 24px;
    border-radius: 18px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
}

.section.active {
    display: block;
}

h2 {
    margin-bottom: 16px;
}

/* ===== CAMERA ===== */
video, canvas {
    width: 100%;
    max-width: 640px;
    border-radius: 12px;
    border: 3px solid var(--primary);
    margin-bottom: 12px;
}

button.action {
    width: 100%;
    padding: 12px;
    margin-top: 8px;
    border-radius: 10px;
    border: none;
    background: var(--primary);
    color: white;
    font-weight: 600;
}

/* ===== INPUT ===== */
input, select {
    width: 100%;
    padding: 10px;
    margin-top: 8px;
    border-radius: 8px;
    border: 1px solid #ccc;
}
</style>
</head>

<body>

<header>
<nav>
    <button onclick="showSection('camera')">ğŸ“¸ êµê³¼ì„œ ì¸ì‹</button>
    <button onclick="showSection('goal')">ğŸ¯ ëª©í‘œ ëŒ€í•™</button>
    <button onclick="showSection('analysis')">ğŸ“Š ì„±ì  ë¶„ì„</button>
    <button onclick="showSection('dashboard')">ğŸ“ˆ ëŒ€ì‹œë³´ë“œ</button>
</nav>
</header>

<main>

<!-- CAMERA -->
<section id="camera" class="section active">
<h2>ğŸ“¸ êµê³¼ì„œ ìë™ ì¸ì‹</h2>
<video id="video" autoplay playsinline muted></video>
<canvas id="canvas" style="display:none"></canvas>

<button class="action" onclick="startCamera()">ì¹´ë©”ë¼ ì‹œì‘</button>
<button class="action" onclick="captureOCR()">ìˆ˜ë™ OCR</button>
<button class="action" onclick="toggleAutoOCR()">ìë™ OCR</button>

<p id="ocrStatus">ìƒíƒœ: ëŒ€ê¸°ì¤‘</p>
<p id="subjectStatus">ê³¼ëª©: ë¯¸ë¶„ë¥˜</p>
</section>

<!-- GOAL -->
<section id="goal" class="section">
<h2>ğŸ¯ ëª©í‘œ ëŒ€í•™ ì„¤ì •</h2>
<select id="targetUniversity"></select>
<p id="targetInfo"></p>
</section>

<!-- ANALYSIS -->
<section id="analysis" class="section">
<h2>ğŸ“Š í˜„ì¬ ì„±ì  ì…ë ¥</h2>
<input type="number" id="kor" placeholder="êµ­ì–´ ë“±ê¸‰">
<input type="number" id="math" placeholder="ìˆ˜í•™ ë“±ê¸‰">
<input type="number" id="eng" placeholder="ì˜ì–´ ë“±ê¸‰">
<input type="number" id="sci" placeholder="íƒêµ¬ í‰ê·  ë“±ê¸‰">
<button class="action" onclick="analyze()">í•©ê²© ê°€ëŠ¥ì„± ë¶„ì„</button>
<div id="analysisResult"></div>
</section>

<!-- DASHBOARD -->
<section id="dashboard" class="section">
<h2>ğŸ“ˆ í•™ìŠµ ëŒ€ì‹œë³´ë“œ</h2>
<p>ì´ OCR íšŸìˆ˜: <span id="ocrCount">0</span></p>
<p>êµ­ì–´ í•™ìŠµ ì‹œê°„: <span id="timeKor">0</span>ë¶„</p>
<p>ìˆ˜í•™ í•™ìŠµ ì‹œê°„: <span id="timeMath">0</span>ë¶„</p>
<p>ì˜ì–´ í•™ìŠµ ì‹œê°„: <span id="timeEng">0</span>ë¶„</p>
</section>

</main>

<script>
/* ===== ëŒ€í•™ ë°ì´í„° (ì›ë³¸ ìœ ì§€) ===== */
const universities = [
  { name:"ì„œìš¸ëŒ€í•™êµ", cutoff:1.3 },
  { name:"ì—°ì„¸ëŒ€í•™êµ", cutoff:1.4 },
  { name:"ê³ ë ¤ëŒ€í•™êµ", cutoff:1.45 },
  { name:"ì„±ê· ê´€ëŒ€í•™êµ", cutoff:1.6 },
  { name:"í•œì–‘ëŒ€í•™êµ", cutoff:1.7 },
  { name:"ì¤‘ì•™ëŒ€í•™êµ", cutoff:1.9 },
  { name:"ê²½í¬ëŒ€í•™êµ", cutoff:2.0 },
  { name:"ì„œê°•ëŒ€í•™êµ", cutoff:1.6 },
  { name:"ì´í™”ì—¬ìëŒ€í•™êµ", cutoff:1.8 },
  { name:"KAIST", cutoff:1.2 }
];

/* ===== ìƒíƒœ ===== */
let stream=null, autoOCR=false, ocrCounter=0;
let studyTime={kor:0,math:0,eng:0};

/* ===== NAV ===== */
function showSection(id){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* ===== INIT ===== */
universities.forEach(u=>{
  const opt=document.createElement('option');
  opt.value=u.name; opt.textContent=u.name;
  targetUniversity.appendChild(opt);
});

/* ===== CAMERA ===== */
async function startCamera(){
  if(stream) return;
  stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});
  video.srcObject=stream;
}

/* ===== OCR ===== */
async function captureOCR(){
  if(!stream) return;
  const ctx=canvas.getContext("2d");
  canvas.width=video.videoWidth;
  canvas.height=video.videoHeight;
  ctx.drawImage(video,0,0);
  ocrStatus.innerText="OCR ë¶„ì„ì¤‘...";
  const {data}=await Tesseract.recognize(canvas,"kor+eng");
  ocrCounter++;
  ocrCount.innerText=ocrCounter;
  classifySubject(data.text);
  ocrStatus.innerText="OCR ì™„ë£Œ";
}

function toggleAutoOCR(){
  autoOCR=!autoOCR;
  if(autoOCR) setInterval(captureOCR,3000);
}

/* ===== SUBJECT ===== */
function classifySubject(text){
  if(text.includes("sin")||text.includes("cos")){
    subjectStatus.innerText="ê³¼ëª©: ìˆ˜í•™"; studyTime.math++;
  } else if(text.match(/[A-Za-z]/)){
    subjectStatus.innerText="ê³¼ëª©: ì˜ì–´"; studyTime.eng++;
  } else {
    subjectStatus.innerText="ê³¼ëª©: êµ­ì–´"; studyTime.kor++;
  }
  timeKor.innerText=studyTime.kor;
  timeMath.innerText=studyTime.math;
  timeEng.innerText=studyTime.eng;
}

/* ===== ANALYSIS ===== */
function analyze(){
  const avg=(+kor.value+ +math.value+ +eng.value+ +sci.value)/4;
  let html="";
  universities.forEach(u=>{
    html+=`<p>${u.name}: ${avg<=u.cutoff?"âœ… ê°€ëŠ¥":"âŒ ì–´ë ¤ì›€"}</p>`;
  });
  analysisResult.innerHTML=html;
}
</script>

</body>
</html>
