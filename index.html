<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="StudyLens AI - AI ê¸°ë°˜ êµê³¼ì„œ ìë™ ì¸ì‹ ë° í•™ìŠµ ê´€ë¦¬ ì‹œìŠ¤í…œ">
    <meta name="keywords" content="StudyLens, AI, êµê³¼ì„œ ì¸ì‹, í•™ìŠµ ê´€ë¦¬, ìˆ˜ëŠ¥, ëŒ€í•™ ì…ì‹œ">
    <meta name="author" content="StudyLens Team">
    
    <title>StudyLens AI - ìŠ¤ë§ˆíŠ¸ êµê³¼ì„œ ì¸ì‹ í•™ìŠµ ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#4c51bf">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="StudyLens AI">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    
    <!-- Tesseract.js OCR Library -->
    <script src='https://unpkg.com/tesseract.js@4.0.2/dist/tesseract.min.js'></script>
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="StudyLens AI - ìŠ¤ë§ˆíŠ¸ êµê³¼ì„œ ì¸ì‹">
    <meta property="og:description" content="AI ê¸°ë°˜ êµê³¼ì„œ ìë™ ì¸ì‹ ë° í•™ìŠµ ê´€ë¦¬ ì‹œìŠ¤í…œ">
    <meta property="og:type" content="website">
    
    <style>
        /* Reset & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            line-height: 1.6;
            font-size: 16px; /* ê¸°ë³¸ í°íŠ¸ í¬ê¸° ì¦ê°€ë¡œ ëª¨ë°”ì¼ ê°€ë…ì„± í–¥ìƒ */
        }
        
        /* Container & Layout */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 10px; /* ëª¨ë°”ì¼ íŒ¨ë”© ê°ì†Œ */
        }
        
        /* Header Styles - ìƒë‹¨ ê³ ì • */
        header {
            background: white;
            border-radius: 15px;
            padding: 20px; /* ëª¨ë°”ì¼ íŒ¨ë”© ì¡°ì • */
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            position: sticky;
            top: 0; /* ìƒë‹¨ ì™„ì „ ê³ ì • */
            z-index: 100;
            width: 100%;
        }
        
        h1 {
            color: #333;
            font-size: 28px; /* ëª¨ë°”ì¼ì—ì„œ 24pxë¡œ ì¡°ì •ë  ì˜ˆì • */
            margin-bottom: 10px;
            text-align: center;
        }
        
        .subtitle {
            color: #666;
            font-size: 14px; /* ëª¨ë°”ì¼ ê°€ë…ì„± */
            margin-bottom: 15px;
            text-align: center;
        }
        
        /* Navigation Menu - ê°„ë‹¨í•œ í•œê¸€ ë©”ë‰´ */
        .nav-menu {
            display: flex;
            gap: 10px; /* ëª¨ë°”ì¼ì—ì„œ ê°„ê²© ì¤„ì„ */
            flex-wrap: wrap;
            border-top: 1px solid #eee;
            padding-top: 15px;
            justify-content: center;
        }
        
        .nav-link {
            background: #4c51bf;
            color: white;
            text-decoration: none;
            padding: 12px 16px; /* ëª¨ë°”ì¼ í„°ì¹˜ ì˜ì—­ í™•ëŒ€ */
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            text-align: center;
            flex: 1;
            min-width: 100px; /* ëª¨ë°”ì¼ ìµœì†Œ ë„ˆë¹„ */
            white-space: nowrap;
        }
        
        .nav-link:hover {
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 81, 191, 0.3);
        }
        
        /* Section Styles */
        .section {
            background: white;
            border-radius: 15px;
            padding: 30px; /* ëª¨ë°”ì¼ 20pxë¡œ ì¡°ì • */
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            animation: fadeIn 0.5s ease;
        }
        
        .section-title {
            color: #333;
            font-size: 22px; /* ëª¨ë°”ì¼ 20px */
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #4c51bf;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 20px; /* ëª¨ë°”ì¼ ê°„ê²© ì¡°ì • */
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 16px; /* ëª¨ë°”ì¼ ê°€ë…ì„± */
        }
        
        select, input {
            width: 100%;
            padding: 14px 15px; /* í„°ì¹˜ ì˜ì—­ í™•ëŒ€ */
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px; /* ëª¨ë°”ì¼ ì…ë ¥ ê°€ë…ì„± */
            transition: all 0.3s;
            background: white;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: #4c51bf;
            box-shadow: 0 0 0 3px rgba(76, 81, 191, 0.1);
        }
        
        /* Buttons */
        button {
            background: #4c51bf;
            color: white;
            border: none;
            padding: 15px 25px; /* ëª¨ë°”ì¼ í„°ì¹˜ ì˜ì—­ */
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(76, 81, 191, 0.3);
            margin: 5px;
            min-height: 48px; /* ëª¨ë°”ì¼ í„°ì¹˜ ìµœì†Œ ë†’ì´ */
        }
        
        button:hover:not(:disabled) {
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 81, 191, 0.4);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-secondary {
            background: #6b7280;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }
        
        .btn-success {
            background: #10b981;
        }
        
        .btn-success:hover {
            background: #059669;
        }
        
        .btn-warning {
            background: #f59e0b;
        }
        
        .btn-warning:hover {
            background: #d97706;
        }
        
        /* Camera Container */
        .camera-container {
            position: relative;
            max-width: 100%; /* ëª¨ë°”ì¼ í’€ ë„ˆë¹„ */
            margin: 0 auto 20px;
        }
        
        #webcam, #canvas {
            width: 100%;
            max-width: 640px;
            height: auto;
            border-radius: 15px;
            border: 3px solid #4c51bf;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        #canvas {
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none;
        }
        
        /* Subject Indicator */
        .subject-indicator {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(76, 81, 191, 0.95);
            color: white;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 20px; /* ëª¨ë°”ì¼ 18px */
            font-weight: bold;
            box-shadow: 0 5px 25px rgba(0,0,0,0.3);
            z-index: 10;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.05); }
        }
        
        /* Subject Timer Grid */
        .subject-timer {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); /* ëª¨ë°”ì¼ì—ì„œ ë” ì‘ê²Œ */
            gap: 12px; /* ëª¨ë°”ì¼ ê°„ê²© ì¤„ì„ */
            margin-top: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
        }
        
        .subject-time-card {
            background: white;
            padding: 15px; /* ëª¨ë°”ì¼ íŒ¨ë”© */
            border-radius: 12px;
            text-align: center;
            border-left: 4px solid #4c51bf;
            box-shadow: 0 3px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s;
        }
        
        .subject-time-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.12);
        }
        
        .subject-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
            font-size: 14px; /* ëª¨ë°”ì¼ ê°€ë…ì„± */
        }
        
        .subject-time {
            font-size: 20px; /* ëª¨ë°”ì¼ 18px */
            color: #4c51bf;
            font-weight: bold;
        }
        
        /* Recognition Status */
        .recognition-status {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            font-weight: 600;
            font-size: 16px;
        }
        
        .status-detecting {
            background: #fff7e6;
            color: #d48806;
            border: 2px solid #ffc53d;
        }
        
        .status-recognized {
            background: #f6ffed;
            color: #52c41a;
            border: 2px solid #52c41a;
        }
        
        .status-none {
            background: #f0f0f0;
            color: #666;
            border: 2px solid #d9d9d9;
        }
        
        .status-error {
            background: #fff1f0;
            color: #ff4d4f;
            border: 2px solid #ff4d4f;
        }
        
        /* Detection Info */
        .detection-info {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            padding: 15px; /* ëª¨ë°”ì¼ íŒ¨ë”© */
            background: #e6f7ff;
            border-radius: 12px;
            flex-wrap: wrap; /* ëª¨ë°”ì¼ ì¤„ë°”ê¿ˆ */
        }
        
        .detection-item {
            text-align: center;
            flex: 1;
            min-width: 80px;
        }
        
        .detection-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .detection-value {
            font-size: 20px; /* ëª¨ë°”ì¼ 18px */
            font-weight: bold;
            color: #1890ff;
        }
        
        /* Manual Subject Selection */
        .manual-select {
            margin-top: 20px;
            padding: 15px; /* ëª¨ë°”ì¼ íŒ¨ë”© */
            background: #f0f0f0;
            border-radius: 12px;
        }
        
        .manual-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); /* ëª¨ë°”ì¼ ë” ë§ì€ ì»¬ëŸ¼ */
            gap: 8px; /* ëª¨ë°”ì¼ ê°„ê²© */
            margin-top: 12px;
        }
        
        .subject-btn {
            padding: 12px;
            border: 2px solid #4c51bf;
            background: white;
            color: #4c51bf;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 14px; /* ëª¨ë°”ì¼ í°íŠ¸ */
            min-height: 44px; /* í„°ì¹˜ ì˜ì—­ */
        }
        
        .subject-btn:hover {
            background: #4c51bf;
            color: white;
            transform: scale(1.05);
        }
        
        .subject-btn.active {
            background: #4c51bf;
            color: white;
        }
        
        /* Timer Display */
        .timer {
            font-size: 48px; /* ëª¨ë°”ì¼ 36px */
            font-weight: bold;
            color: #4c51bf;
            text-align: center;
            margin: 25px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        /* Statistics Section */
        .stats-section {
            margin-top: 25px;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
        }
        
        .stats-section h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 18px;
        }
        
        .stats-section p {
            margin: 8px 0;
            font-size: 15px; /* ëª¨ë°”ì¼ ê°€ë…ì„± */
        }
        
        .stats-section strong {
            color: #4c51bf;
            font-size: 16px;
        }
        
        /* Grade Input Grid */
        .grade-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); /* ëª¨ë°”ì¼ 2ì»¬ëŸ¼ */
            gap: 12px;
        }
        
        /* Result Box */
        .result-box {
            background: #f7f7f7;
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
        }
        
        /* Study Plan Item */
        .study-plan {
            background: white;
            border-left: 4px solid #4c51bf;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        
        /* University Recommendation Card */
        .university-recommendation {
            background: #e6f7ff;
            border: 1px solid #91d5ff;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        
        /* Dashboard Stats Grid */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); /* ëª¨ë°”ì¼ 2x2 */
            gap: 15px; /* ëª¨ë°”ì¼ ê°„ê²© */
            margin: 25px 0;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }
        
        .stat-value {
            font-size: 32px; /* ëª¨ë°”ì¼ 28px */
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 13px;
            opacity: 0.9;
        }
        
        /* Control Buttons Container */
        .control-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }
        
        /* Utility Classes */
        .hidden {
            display: none !important;
        }
        
        .text-center {
            text-align: center;
        }
        
        .mt-3 {
            margin-top: 30px;
        }
        
        .mb-3 {
            margin-bottom: 30px;
        }
        
        /* Responsive Design - ê°•í™”ëœ ëª¨ë°”ì¼ ì§€ì› */
        @media (max-width: 768px) {
            body {
                font-size: 15px; /* ì „ì²´ í°íŠ¸ ìŠ¤ì¼€ì¼ë§ */
            }
            
            .container {
                padding: 5px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .subtitle {
                font-size: 13px;
            }
            
            .nav-menu {
                flex-direction: column;
                gap: 8px;
            }
            
            .nav-link {
                width: 100%;
                text-align: center;
                min-width: auto;
                padding: 14px;
            }
            
            .section {
                padding: 20px;
                margin-bottom: 15px;
            }
            
            .section-title {
                font-size: 20px;
            }
            
            .timer {
                font-size: 36px;
            }
            
            .subject-timer {
                grid-template-columns: repeat(2, 1fr); /* ëª¨ë°”ì¼ 2ì—´ */
                gap: 10px;
            }
            
            .subject-time {
                font-size: 18px;
            }
            
            .detection-info {
                flex-direction: column;
                gap: 10px;
            }
            
            .detection-value {
                font-size: 18px;
            }
            
            .manual-buttons {
                grid-template-columns: repeat(2, 1fr); /* ëª¨ë°”ì¼ 2ì—´ */
                gap: 6px;
            }
            
            .subject-btn {
                font-size: 13px;
                padding: 10px;
            }
            
            .control-buttons {
                flex-direction: column;
            }
            
            .control-buttons button {
                width: 100%;
            }
            
            .grade-inputs {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .dashboard-stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .stat-value {
                font-size: 28px;
            }
            
            .stats-section p {
                font-size: 14px;
            }
        }
        
        @media (max-width: 480px) {
            .subject-timer {
                grid-template-columns: 1fr; /* ì‘ì€ í™”ë©´ 1ì—´ */
            }
            
            .manual-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section - ìƒë‹¨ ê³ ì • -->
        <header>
            <h1>ğŸ“š StudyLens AI</h1>
            <p class="subtitle">AI ê¸°ë°˜ ìŠ¤ë§ˆíŠ¸ êµê³¼ì„œ ì¸ì‹ & í•™ìŠµ ê´€ë¦¬ ì‹œìŠ¤í…œ</p>
            
            <!-- Navigation Menu - ê°„ë‹¨í•œ í•œê¸€ ë©”ë‰´ -->
            <nav class="nav-menu">
                <a href="#section-tracker" class="nav-link">ğŸ“¸ êµê³¼ì„œ ì¸ì‹</a>
                <a href="#section-goal" class="nav-link">ğŸ¯ ëª©í‘œ ì„¤ì •</a>
                <a href="#section-current" class="nav-link">ğŸ“Š ì„±ì  ë¶„ì„</a>
                <a href="#section-dashboard" class="nav-link">ğŸ“ˆ ëŒ€ì‹œë³´ë“œ</a>
            </nav>
        </header>

        <!-- Section 1: êµê³¼ì„œ ì¸ì‹ - ìˆ˜ë™ ì¸ì‹ìœ¼ë¡œ ë³€ê²½ -->
        <section id="section-tracker" class="section">
            <h2 class="section-title">
                <span>ğŸ“¸</span>
                <span>êµê³¼ì„œ ìˆ˜ë™ ì¸ì‹ & í•™ìŠµ ì‹œê°„ ì¶”ì </span>
            </h2>
            
            <div class="camera-container">
                <video id="webcam" autoplay playsinline></video>
                <canvas id="canvas"></canvas>
                
                <div id="subjectIndicator" class="subject-indicator hidden">
                    <span id="currentSubject">ê°ì§€ì¤‘...</span>
                </div>
            </div>
            
            <div id="recognitionStatus" class="recognition-status status-none">
                ğŸ“· ì¹´ë©”ë¼ë¥¼ ì‹œì‘í•˜ê³  êµê³¼ì„œë¥¼ ë³´ì—¬ì£¼ì„¸ìš”
            </div>
            
            <div class="control-buttons">
                <button onclick="startCamera()" id="startBtn" class="btn-success">
                    ğŸ¥ ì¹´ë©”ë¼ ì‹œì‘
                </button>
                <button onclick="stopCamera()" id="stopBtn" class="hidden btn-secondary">
                    â¹ï¸ ì¹´ë©”ë¼ ì¢…ë£Œ
                </button>
                <button onclick="captureTextbook()" id="captureBtn" class="hidden">
                    ğŸ“¸ êµê³¼ì„œ ì¸ì‹í•˜ê¸° (ìˆ˜ë™)
                </button>
            </div>
            
            <div class="manual-select">
                <p><strong>ìˆ˜ë™ ê³¼ëª© ì„ íƒ</strong> (ì¶”ì²œ: ìë™ ì¸ì‹ ëŒ€ì‹  ì‚¬ìš©)</p>
                <div class="manual-buttons">
                    <button class="subject-btn" onclick="selectSubject('êµ­ì–´')">êµ­ì–´</button>
                    <button class="subject-btn" onclick="selectSubject('ìˆ˜í•™')">ìˆ˜í•™</button>
                    <button class="subject-btn" onclick="selectSubject('ì˜ì–´')">ì˜ì–´</button>
                    <button class="subject-btn" onclick="selectSubject('ë¬¼ë¦¬')">ë¬¼ë¦¬</button>
                    <button class="subject-btn" onclick="selectSubject('í™”í•™')">í™”í•™</button>
                    <button class="subject-btn" onclick="selectSubject('ìƒë¬¼')">ìƒë¬¼</button>
                    <button class="subject-btn" onclick="selectSubject('í•œêµ­ì‚¬')">í•œêµ­ì‚¬</button>
                    <button class="subject-btn" onclick="selectSubject('ì‚¬íšŒ')">ì‚¬íšŒ</button>
                </div>
            </div>
            
            <div class="detection-info">
                <div class="detection-item">
                    <div class="detection-label">ì¸ì‹ ì •í™•ë„</div>
                    <div class="detection-value" id="accuracy">0%</div>
                </div>
                <div class="detection-item">
                    <div class="detection-label">ê°ì§€ëœ í…ìŠ¤íŠ¸</div>
                    <div class="detection-value" id="detectedText">-</div>
                </div>
                <div class="detection-item">
                    <div class="detection-label">ìƒ‰ìƒ ë¶„ì„</div>
                    <div class="detection-value" id="colorAnalysis">-</div>
                </div>
            </div>
            
            <div class="timer" id="totalTimer">00:00:00</div>
            
            <div class="subject-timer">
                <div class="subject-time-card">
                    <div class="subject-name">ğŸ“– êµ­ì–´</div>
                    <div class="subject-time" id="time-êµ­ì–´">0ë¶„</div>
                </div>
                <div class="subject-time-card">
                    <div class="subject-name">ğŸ”¢ ìˆ˜í•™</div>
                    <div class="subject-time" id="time-ìˆ˜í•™">0ë¶„</div>
                </div>
                <div class="subject-time-card">
                    <div class="subject-name">ğŸŒ ì˜ì–´</div>
                    <div class="subject-time" id="time-ì˜ì–´">0ë¶„</div>
                </div>
                <div class="subject-time-card">
                    <div class="subject-name">âš›ï¸ ë¬¼ë¦¬</div>
                    <div class="subject-time" id="time-ë¬¼ë¦¬">0ë¶„</div>
                </div>
                <div class="subject-time-card">
                    <div class="subject-name">ğŸ§ª í™”í•™</div>
                    <div class="subject-time" id="time-í™”í•™">0ë¶„</div>
                </div>
                <div class="subject-time-card">
                    <div class="subject-name">ğŸ¦  ìƒë¬¼</div>
                    <div class="subject-time" id="time-ìƒë¬¼">0ë¶„</div>
                </div>
                <div class="subject-time-card">
                    <div class="subject-name">ğŸ›ï¸ í•œêµ­ì‚¬</div>
                    <div class="subject-time" id="time-í•œêµ­ì‚¬">0ë¶„</div>
                </div>
                <div class="subject-time-card">
                    <div class="subject-name">ğŸŒ ì‚¬íšŒ</div>
                    <div class="subject-time" id="time-ì‚¬íšŒ">0ë¶„</div>
                </div>
            </div>
            
            <div class="stats-section">
                <h3>ğŸ“Š ì˜¤ëŠ˜ì˜ í•™ìŠµ ë¶„ì„</h3>
                <p>ğŸ“š ê°€ì¥ ë§ì´ ê³µë¶€í•œ ê³¼ëª©: <strong id="topSubject">-</strong></p>
                <p>â±ï¸ ì´ í•™ìŠµ ì‹œê°„: <strong id="totalStudyTime">0ì‹œê°„ 0ë¶„</strong></p>
                <p>ğŸ¯ ì§‘ì¤‘ë„: <strong id="concentration">0%</strong></p>
                <p>ğŸ“ˆ ëª©í‘œ ë‹¬ì„±ë¥ : <strong id="achievement">0%</strong></p>
            </div>
        </section>

        <!-- Section 2: ëª©í‘œ ëŒ€í•™ ì„¤ì • -->
        <section id="section-goal" class="section">
            <h2 class="section-title">
                <span>ğŸ¯</span>
                <span>ëª©í‘œ ëŒ€í•™ ê¸°ë°˜ í•™ìŠµ ê³„íš</span>
            </h2>
            
            <div class="form-group">
                <label>ëª©í‘œ ëŒ€í•™ ì„ íƒ</label>
                <select id="targetUniversity" onchange="updateDepartments()">
                    <option value="">ëŒ€í•™ì„ ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="ì„œìš¸ëŒ€">ì„œìš¸ëŒ€í•™êµ</option>
                    <option value="ì—°ì„¸ëŒ€">ì—°ì„¸ëŒ€í•™êµ</option>
                    <option value="ê³ ë ¤ëŒ€">ê³ ë ¤ëŒ€í•™êµ</option>
                    <option value="ì„±ê· ê´€ëŒ€">ì„±ê· ê´€ëŒ€í•™êµ</option>
                    <option value="í•œì–‘ëŒ€">í•œì–‘ëŒ€í•™êµ</option>
                    <option value="ì„œê°•ëŒ€">ì„œê°•ëŒ€í•™êµ</option>
                    <option value="ì¤‘ì•™ëŒ€">ì¤‘ì•™ëŒ€í•™êµ</option>
                    <option value="ê²½í¬ëŒ€">ê²½í¬ëŒ€í•™êµ</option>
                    <option value="í•œêµ­ì™¸ëŒ€">í•œêµ­ì™¸êµ­ì–´ëŒ€í•™êµ</option>
                    <option value="ì„œìš¸ì‹œë¦½ëŒ€">ì„œìš¸ì‹œë¦½ëŒ€í•™êµ</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>ëª©í‘œ í•™ê³¼ ì„ íƒ</label>
                <select id="targetDepartment">
                    <option value="">ë¨¼ì € ëŒ€í•™ì„ ì„ íƒí•˜ì„¸ìš”</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>ìˆ˜ëŠ¥ê¹Œì§€ ë‚¨ì€ ì¼ìˆ˜</label>
                <input type="number" id="daysRemaining" value="300" min="1" max="365">
            </div>
            
            <button onclick="generatePlanFromGoal()">ğŸ¤– AI í•™ìŠµ ê³„íš ìƒì„±</button>
            
            <div id="goalResult" class="result-box hidden"></div>
        </section>

        <!-- Section 3: ì„±ì  ë¶„ì„ -->
        <section id="section-current" class="section">
            <h2 class="section-title">
                <span>ğŸ“Š</span>
                <span>í˜„ì¬ ì„±ì  ê¸°ë°˜ ëŒ€í•™ ì¶”ì²œ</span>
            </h2>
            
            <div class="form-group">
                <label>í˜„ì¬ ë“±ê¸‰ ì…ë ¥ (1-9ë“±ê¸‰)</label>
                <div class="grade-inputs">
                    <div>
                        <label style="font-weight: normal; font-size: 14px;">êµ­ì–´</label>
                        <input type="number" id="grade-korean" min="1" max="9" value="3">
                    </div>
                    <div>
                        <label style="font-weight: normal; font-size: 14px;">ìˆ˜í•™</label>
                        <input type="number" id="grade-math" min="1" max="9" value="3">
                    </div>
                    <div>
                        <label style="font-weight: normal; font-size: 14px;">ì˜ì–´</label>
                        <input type="number" id="grade-english" min="1" max="9" value="3">
                    </div>
                    <div>
                        <label style="font-weight: normal; font-size: 14px;">íƒêµ¬1</label>
                        <input type="number" id="grade-science1" min="1" max="9" value="3">
                    </div>
                    <div>
                        <label style="font-weight: normal; font-size: 14px;">íƒêµ¬2</label>
                        <input type="number" id="grade-science2" min="1" max="9" value="3">
                    </div>
                </div>
            </div>
            
            <button onclick="recommendUniversities()">ğŸ“ ì§„í•™ ê°€ëŠ¥ ëŒ€í•™ ë¶„ì„</button>
            
            <div id="currentResult" class="result-box hidden"></div>
        </section>

        <!-- Section 4: í•™ìŠµ ëŒ€ì‹œë³´ë“œ -->
        <section id="section-dashboard" class="section">
            <h2 class="section-title">
                <span>ğŸ“ˆ</span>
                <span>í•™ìŠµ ëŒ€ì‹œë³´ë“œ</span>
            </h2>
            
            <div class="dashboard-stats">
                <div class="stat-card">
                    <div class="stat-value">D-287</div>
                    <div class="stat-label">ìˆ˜ëŠ¥ê¹Œì§€</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="weeklyHours">0h</div>
                    <div class="stat-label">ì£¼ê°„ í•™ìŠµ ì‹œê°„</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="dashAchievement">0%</div>
                    <div class="stat-label">ëª©í‘œ ë‹¬ì„±ë¥ </div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">15ìœ„</div>
                    <div class="stat-label">ì „ì²´ ë­í‚¹</div>
                </div>
            </div>
            
            <div style="margin-top: 25px;">
                <h3>ğŸ“Š ì£¼ê°„ í•™ìŠµ ë¶„ì„</h3>
                <canvas id="weeklyChart" width="400" height="200" style="max-width: 100%;"></canvas>
            </div>
            
            <div style="margin-top: 25px;">
                <h3>ğŸ¯ ì´ë²ˆ ì£¼ ëª©í‘œ</h3>
                <div class="study-plan">
                    <strong>ìˆ˜í•™:</strong> ë¯¸ì ë¶„ 3ë‹¨ì› ì™„ë£Œ (ì§„ë„ìœ¨ 65%)
                </div>
                <div class="study-plan">
                    <strong>ì˜ì–´:</strong> ëª¨ì˜ê³ ì‚¬ 3íšŒ (2/3 ì™„ë£Œ)
                </div>
                <div class="study-plan">
                    <strong>êµ­ì–´:</strong> ë¹„ë¬¸í•™ ì§€ë¬¸ 20ê°œ (18/20 ì™„ë£Œ)
                </div>
                <div class="study-plan">
                    <strong>íƒêµ¬:</strong> ë¬¼ë¦¬ ì—­í•™ ë‹¨ì› ì •ë¦¬ (ì§„ë„ìœ¨ 80%)
                </div>
            </div>
        </section>
    </div>

    <script>
        // =====================================================
        // Global Variables & Configuration
        // =====================================================
        
        let stream = null;
        let currentSubject = null;
        let subjectTimers = {};
        let totalStartTime = null;
        let subjectStartTime = null;
        let totalTimerInterval = null;
        let isTracking = false;
        
        // Initialize subject timers
        const subjects = ['êµ­ì–´', 'ìˆ˜í•™', 'ì˜ì–´', 'ë¬¼ë¦¬', 'í™”í•™', 'ìƒë¬¼', 'í•œêµ­ì‚¬', 'ì‚¬íšŒ'];
        subjects.forEach(subject => {
            subjectTimers[subject] = 0;
        });
        
        // Textbook color patterns (based on Korean textbook standards)
        const textbookColors = {
            'êµ­ì–´': { r: 150, g: 100, b: 50 },    // Brown
            'ìˆ˜í•™': { r: 50, g: 100, b: 200 },    // Blue
            'ì˜ì–´': { r: 200, g: 150, b: 50 },    // Yellow
            'ë¬¼ë¦¬': { r: 100, g: 150, b: 100 },   // Green
            'í™”í•™': { r: 150, g: 50, b: 150 },    // Purple
            'ìƒë¬¼': { r: 50, g: 150, b: 50 },     // Green
            'í•œêµ­ì‚¬': { r: 180, g: 130, b: 70 },  // Brown
            'ì‚¬íšŒ': { r: 100, g: 100, b: 100 }    // Gray
        };
        
        // Textbook title keywords for recognition
        const textbookKeywords = {
            'êµ­ì–´': ['êµ­ì–´', 'ë¬¸í•™', 'ì–¸ì–´', 'ë…ì„œ', 'í™”ë²•', 'ì‘ë¬¸'],
            'ìˆ˜í•™': ['ìˆ˜í•™', 'ë¯¸ì ë¶„', 'í™•ë¥ ', 'í†µê³„', 'ê¸°í•˜', 'ëŒ€ìˆ˜', 'í•¨ìˆ˜'],
            'ì˜ì–´': ['English', 'ì˜ì–´', 'Reading', 'Grammar', 'Listening'],
            'ë¬¼ë¦¬': ['ë¬¼ë¦¬', 'Physics', 'ì—­í•™', 'ì „ìê¸°', 'íŒŒë™'],
            'í™”í•™': ['í™”í•™', 'Chemistry', 'ì›ì†Œ', 'í™”í•©ë¬¼', 'ë°˜ì‘'],
            'ìƒë¬¼': ['ìƒë¬¼', 'Biology', 'ìƒëª…', 'ê³¼í•™', 'ì„¸í¬'],
            'í•œêµ­ì‚¬': ['í•œêµ­ì‚¬', 'ì—­ì‚¬', 'êµ­ì‚¬', 'ê·¼í˜„ëŒ€ì‚¬'],
            'ì‚¬íšŒ': ['ì‚¬íšŒ', 'ì •ì¹˜', 'ê²½ì œ', 'ì§€ë¦¬', 'ìœ¤ë¦¬', 'ë²•']
        };
        
        // University database
        const universityDB = {
            "ì„œìš¸ëŒ€": {
                departments: {
                    "ê²½ì˜í•™ê³¼": { avgGrade: 1.2, competition: 15.3, minScore: 95 },
                    "ì»´í“¨í„°ê³µí•™ë¶€": { avgGrade: 1.3, competition: 12.8, minScore: 94 },
                    "ì˜ì˜ˆê³¼": { avgGrade: 1.0, competition: 25.4, minScore: 98 },
                    "ê³µê³¼ëŒ€í•™": { avgGrade: 1.5, competition: 8.7, minScore: 92 }
                }
            },
            "ì—°ì„¸ëŒ€": {
                departments: {
                    "ê²½ì˜í•™ê³¼": { avgGrade: 1.4, competition: 18.2, minScore: 93 },
                    "ì „ê¸°ì „ìê³µí•™ë¶€": { avgGrade: 1.6, competition: 10.3, minScore: 91 },
                    "ì˜ì˜ˆê³¼": { avgGrade: 1.1, competition: 28.6, minScore: 97 },
                    "ë¬¸ê³¼ëŒ€í•™": { avgGrade: 1.8, competition: 7.5, minScore: 89 }
                }
            },
            "ê³ ë ¤ëŒ€": {
                departments: {
                    "ê²½ì˜ëŒ€í•™": { avgGrade: 1.5, competition: 16.8, minScore: 92 },
                    "ì»´í“¨í„°í•™ê³¼": { avgGrade: 1.7, competition: 14.2, minScore: 90 },
                    "ì˜ê³¼ëŒ€í•™": { avgGrade: 1.1, competition: 27.3, minScore: 97 },
                    "ê³µê³¼ëŒ€í•™": { avgGrade: 1.8, competition: 9.5, minScore: 88 }
                }
            },
            "ì„±ê· ê´€ëŒ€": {
                departments: {
                    "ê¸€ë¡œë²Œê²½ì˜": { avgGrade: 1.8, competition: 12.5, minScore: 88 },
                    "ë°˜ë„ì²´ì‹œìŠ¤í…œ": { avgGrade: 1.9, competition: 11.2, minScore: 87 },
                    "ì†Œí”„íŠ¸ì›¨ì–´": { avgGrade: 2.0, competition: 10.8, minScore: 86 },
                    "ìì—°ê³¼í•™": { avgGrade: 2.2, competition: 8.3, minScore: 84 }
                }
            },
            "í•œì–‘ëŒ€": {
                departments: {
                    "íŒŒì´ë‚¸ìŠ¤ê²½ì˜": { avgGrade: 1.9, competition: 13.2, minScore: 87 },
                    "ì»´í“¨í„°ì†Œí”„íŠ¸ì›¨ì–´": { avgGrade: 2.0, competition: 11.5, minScore: 86 },
                    "ê¸°ê³„ê³µí•™": { avgGrade: 2.1, competition: 9.8, minScore: 85 },
                    "ê±´ì¶•í•™ë¶€": { avgGrade: 2.2, competition: 8.7, minScore: 84 }
                }
            },
            "ì„œê°•ëŒ€": {
                departments: {
                    "ê²½ì˜í•™": { avgGrade: 1.7, competition: 14.5, minScore: 90 },
                    "ì»´í“¨í„°ê³µí•™": { avgGrade: 1.8, competition: 12.3, minScore: 89 },
                    "ì „ìê³µí•™": { avgGrade: 1.9, competition: 10.2, minScore: 88 },
                    "ì¸ë¬¸í•™ë¶€": { avgGrade: 2.0, competition: 8.5, minScore: 86 }
                }
            },
            "ì¤‘ì•™ëŒ€": {
                departments: {
                    "ê²½ì˜ê²½ì œ": { avgGrade: 2.3, competition: 10.5, minScore: 83 },
                    "ê³µê³¼ëŒ€í•™": { avgGrade: 2.5, competition: 8.2, minScore: 81 },
                    "ì˜í•™ë¶€": { avgGrade: 1.3, competition: 22.3, minScore: 94 },
                    "ì˜ˆìˆ ëŒ€í•™": { avgGrade: 2.8, competition: 15.2, minScore: 78 }
                }
            },
            "ê²½í¬ëŒ€": {
                departments: {
                    "í•œì˜ì˜ˆê³¼": { avgGrade: 1.5, competition: 20.5, minScore: 92 },
                    "í˜¸í…”ê²½ì˜": { avgGrade: 2.4, competition: 12.3, minScore: 82 },
                    "êµ­ì œí•™ë¶€": { avgGrade: 2.3, competition: 11.2, minScore: 83 },
                    "ê³µê³¼ëŒ€í•™": { avgGrade: 2.6, competition: 7.8, minScore: 80 }
                }
            },
            "í•œêµ­ì™¸ëŒ€": {
                departments: {
                    "í†µë²ˆì—­ëŒ€í•™": { avgGrade: 2.2, competition: 18.5, minScore: 84 },
                    "êµ­ì œì§€ì—­ëŒ€í•™": { avgGrade: 2.5, competition: 10.2, minScore: 81 },
                    "ê²½ì˜í•™ë¶€": { avgGrade: 2.6, competition: 8.7, minScore: 80 },
                    "ì–´ë¬¸í•™ë¶€": { avgGrade: 2.7, competition: 7.5, minScore: 79 }
                }
            },
            "ì„œìš¸ì‹œë¦½ëŒ€": {
                departments: {
                    "ë„ì‹œê³µí•™": { avgGrade: 2.2, competition: 12.8, minScore: 84 },
                    "ì„¸ë¬´í•™ê³¼": { avgGrade: 2.3, competition: 14.2, minScore: 83 },
                    "ë„ì‹œí–‰ì •": { avgGrade: 2.4, competition: 10.5, minScore: 82 },
                    "ììœ ì „ê³µ": { avgGrade: 2.5, competition: 8.3, minScore: 81 }
                }
            }
        };
        
        // =====================================================
        // Camera & Recognition Functions - ìë™ ì¸ì‹ ì œê±°
        // =====================================================
        
        async function startCamera() {
            try {
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        width: { ideal: 640 },
                        height: { ideal: 480 },
                        facingMode: 'environment'
                    } 
                });
                
                const video = document.getElementById('webcam');
                video.srcObject = stream;
                
                document.getElementById('startBtn').classList.add('hidden');
                document.getElementById('stopBtn').classList.remove('hidden');
                document.getElementById('captureBtn').classList.remove('hidden');
                
                startTotalTimer();
                updateStatus('ğŸ“· ì¹´ë©”ë¼ê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤. êµê³¼ì„œ ì¸ì‹ ë²„íŠ¼ì„ ëˆ„ë¥´ê±°ë‚˜ ìˆ˜ë™ ì„ íƒí•˜ì„¸ìš”.', 'none');
                
            } catch (err) {
                console.error('Camera error:', err);
                alert('ì¹´ë©”ë¼ ì ‘ê·¼ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ ì¹´ë©”ë¼ë¥¼ í—ˆìš©í•´ì£¼ì„¸ìš”.');
            }
        }
        
        function stopCamera() {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                stream = null;
            }
            
            document.getElementById('startBtn').classList.remove('hidden');
            document.getElementById('stopBtn').classList.add('hidden');
            document.getElementById('captureBtn').classList.add('hidden');
            
            stopTotalTimer();
            updateStatus('ğŸ“· ì¹´ë©”ë¼ê°€ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤', 'none');
        }
        
        async function captureTextbook() {
            const video = document.getElementById('webcam');
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            
            if (!video.videoWidth || !video.videoHeight) {
                updateStatus('âŒ ì¹´ë©”ë¼ê°€ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤', 'error');
                return;
            }
            
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            ctx.drawImage(video, 0, 0);
            
            // Color analysis
            const colorResult = analyzeColor(ctx);
            
            updateStatus('ğŸ” êµê³¼ì„œë¥¼ ì¸ì‹í•˜ëŠ” ì¤‘...', 'detecting');
            
            try {
                const result = await Tesseract.recognize(
                    canvas.toDataURL(),
                    'kor+eng',
                    {
                        logger: m => {
                            if (m.status === 'recognizing text') {
                                document.getElementById('accuracy').textContent = 
                                    Math.round(m.progress * 100) + '%';
                            }
                        }
                    }
                );
                
                const text = result.data.text.toLowerCase();
                const confidence = result.data.confidence;
                
                const detectedSubject = detectSubject(text, colorResult);
                
                if (detectedSubject) {
                    setCurrentSubject(detectedSubject);
                    
                    document.getElementById('detectedText').textContent = 
                        text.substring(0, 20) + (text.length > 20 ? '...' : '');
                    document.getElementById('accuracy').textContent = 
                        Math.round(confidence) + '%';
                    
                    updateStatus(`âœ… ${detectedSubject} êµê³¼ì„œê°€ ì¸ì‹ë˜ì—ˆìŠµë‹ˆë‹¤!`, 'recognized');
                } else {
                    updateStatus('âŒ êµê³¼ì„œë¥¼ ì¸ì‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
                }
                
            } catch (err) {
                console.error('OCR error:', err);
                updateStatus('âš ï¸ í…ìŠ¤íŠ¸ ì¸ì‹ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìƒ‰ìƒ ë¶„ì„ì„ ì‹œë„í•©ë‹ˆë‹¤...', 'detecting');
                if (colorResult.subject) {
                    setCurrentSubject(colorResult.subject);
                    updateStatus(`âœ… ${colorResult.subject} êµê³¼ì„œê°€ ìƒ‰ìƒìœ¼ë¡œ ì¸ì‹ë˜ì—ˆìŠµë‹ˆë‹¤!`, 'recognized');
                } else {
                    updateStatus('âŒ ì¸ì‹ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
                }
            }
        }
        
        function analyzeColor(ctx) {
            const imageData = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);
            const data = imageData.data;
            
            let r = 0, g = 0, b = 0;
            let pixels = 0;
            
            const centerX = Math.floor(ctx.canvas.width / 2);
            const centerY = Math.floor(ctx.canvas.height / 2);
            const sampleSize = 100;
            
            for (let x = centerX - sampleSize; x < centerX + sampleSize; x += 5) {
                for (let y = centerY - sampleSize; y < centerY + sampleSize; y += 5) {
                    if (x < 0 || y < 0 || x >= ctx.canvas.width || y >= ctx.canvas.height) continue;
                    
                    const idx = (y * ctx.canvas.width + x) * 4;
                    r += data[idx];
                    g += data[idx + 1];
                    b += data[idx + 2];
                    pixels++;
                }
            }
            
            if (pixels > 0) {
                r = Math.floor(r / pixels);
                g = Math.floor(g / pixels);
                b = Math.floor(b / pixels);
            }
            
            let minDistance = Infinity;
            let detectedSubject = null;
            
            for (const [subject, color] of Object.entries(textbookColors)) {
                const distance = Math.sqrt(
                    Math.pow(r - color.r, 2) +
                    Math.pow(g - color.g, 2) +
                    Math.pow(b - color.b, 2)
                );
                
                if (distance < minDistance && distance < 100) {
                    minDistance = distance;
                    detectedSubject = subject;
                }
            }
            
            const colorHex = '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
            document.getElementById('colorAnalysis').textContent = colorHex;
            document.getElementById('colorAnalysis').style.color = colorHex;
            
            return { subject: detectedSubject, color: { r, g, b } };
        }
        
        function detectSubject(text, colorResult) {
            let maxScore = 0;
            let detectedSubject = null;
            
            for (const [subject, keywords] of Object.entries(textbookKeywords)) {
                let score = 0;
                
                keywords.forEach(keyword => {
                    if (text.includes(keyword.toLowerCase())) {
                        score += 10;
                    }
                });
                
                if (colorResult.subject === subject) {
                    score += 5;
                }
                
                if (score > maxScore) {
                    maxScore = score;
                    detectedSubject = subject;
                }
            }
            
            return maxScore > 0 ? detectedSubject : null;
        }
        
        // =====================================================
        // Subject & Timer Management
        // =====================================================
        
        function setCurrentSubject(subject) {
            if (currentSubject && subjectStartTime) {
                const elapsed = Date.now() - subjectStartTime;
                subjectTimers[currentSubject] += elapsed;
                updateSubjectTime(currentSubject);
            }
            
            currentSubject = subject;
            subjectStartTime = Date.now();
            
            document.getElementById('currentSubject').textContent = subject;
            document.getElementById('subjectIndicator').classList.remove('hidden');
            
            document.querySelectorAll('.subject-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent === subject) {
                    btn.classList.add('active');
                }
            });
        }
        
        function selectSubject(subject) {
            setCurrentSubject(subject);
            updateStatus(`ğŸ“š ${subject} ê³¼ëª©ì´ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤`, 'recognized');
        }
        
        function updateSubjectTime(subject) {
            const minutes = Math.floor(subjectTimers[subject] / 60000);
            const hours = Math.floor(minutes / 60);
            const mins = minutes % 60;
            
            let timeText = '';
            if (hours > 0) {
                timeText = `${hours}ì‹œê°„ ${mins}ë¶„`;
            } else {
                timeText = `${mins}ë¶„`;
            }
            
            document.getElementById(`time-${subject}`).textContent = timeText;
            updateStatistics();
        }
        
        function startTotalTimer() {
            if (totalTimerInterval) return;
            
            totalStartTime = Date.now();
            isTracking = true;
            
            totalTimerInterval = setInterval(() => {
                const elapsed = Date.now() - totalStartTime;
                const hours = Math.floor(elapsed / 3600000);
                const minutes = Math.floor((elapsed % 3600000) / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                
                document.getElementById('totalTimer').textContent = 
                    `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                
                if (currentSubject && subjectStartTime) {
                    updateSubjectTime(currentSubject);
                }
                
                updateDashboard();
            }, 1000);
        }
        
        function stopTotalTimer() {
            if (totalTimerInterval) {
                clearInterval(totalTimerInterval);
                totalTimerInterval = null;
            }
            
            if (currentSubject && subjectStartTime) {
                const elapsed = Date.now() - subjectStartTime;
                subjectTimers[currentSubject] += elapsed;
                updateSubjectTime(currentSubject);
            }
            
            isTracking = false;
        }
        
        // =====================================================
        // Statistics & Dashboard
        // =====================================================
        
        function updateStatistics() {
            let totalMinutes = 0;
            let topSubject = '';
            let maxTime = 0;
            
            for (const [subject, time] of Object.entries(subjectTimers)) {
                totalMinutes += Math.floor(time / 60000);
                if (time > maxTime) {
                    maxTime = time;
                    topSubject = subject;
                }
            }
            
            const hours = Math.floor(totalMinutes / 60);
            const mins = totalMinutes % 60;
            
            document.getElementById('totalStudyTime').textContent = 
                `${hours}ì‹œê°„ ${mins}ë¶„`;
            document.getElementById('topSubject').textContent = 
                topSubject || '-';
            
            const concentration = Math.min(100, Math.floor(70 + Math.random() * 30));
            document.getElementById('concentration').textContent = concentration + '%';
            
            const achievement = Math.min(100, Math.floor((totalMinutes / 480) * 100));
            document.getElementById('achievement').textContent = achievement + '%';
        }
        
        function updateDashboard() {
            if (!isTracking) return;
            
            const totalMinutes = Object.values(subjectTimers)
                .reduce((sum, time) => sum + Math.floor(time / 60000), 0);
            const hours = Math.floor(totalMinutes / 60);
            
            document.getElementById('weeklyHours').textContent = hours + 'h';
            
            const achievement = Math.min(100, Math.floor((totalMinutes / 480) * 100));
            document.getElementById('dashAchievement').textContent = achievement + '%';
        }
        
        function updateStatus(message, type) {
            const statusDiv = document.getElementById('recognitionStatus');
            statusDiv.textContent = message;
            
            statusDiv.className = 'recognition-status';
            if (type === 'detecting') {
                statusDiv.classList.add('status-detecting');
            } else if (type === 'recognized') {
                statusDiv.classList.add('status-recognized');
            } else if (type === 'error') {
                statusDiv.classList.add('status-error');
            } else {
                statusDiv.classList.add('status-none');
            }
        }
        
        // =====================================================
        // University Functions
        // =====================================================
        
        function updateDepartments() {
            const univ = document.getElementById('targetUniversity').value;
            const deptSelect = document.getElementById('targetDepartment');
            
            deptSelect.innerHTML = '<option value="">í•™ê³¼ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>';
            
            if (univ && universityDB[univ]) {
                Object.keys(universityDB[univ].departments).forEach(dept => {
                    const option = document.createElement('option');
                    option.value = dept;
                    option.textContent = dept;
                    deptSelect.appendChild(option);
                });
            }
        }
        
        function generatePlanFromGoal() {
            const univ = document.getElementById('targetUniversity').value;
            const dept = document.getElementById('targetDepartment').value;
            const days = document.getElementById('daysRemaining').value;
            
            if (!univ || !dept) {
                alert('ëŒ€í•™ê³¼ í•™ê³¼ë¥¼ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const deptInfo = universityDB[univ].departments[dept];
            const resultDiv = document.getElementById('goalResult');
            
            // í•™ìŠµ ê³„íš ìƒì„±
            const studyHours = calculateStudyHours(deptInfo.avgGrade, days);
            
            resultDiv.innerHTML = `
                <h3>ğŸ¯ ${univ} ${dept} ë§ì¶¤ í•™ìŠµ ê³„íš</h3>
                
                <div style="margin: 20px 0;">
                    <h4>ğŸ“Š ì…ì‹œ ì •ë³´</h4>
                    <p>â€¢ í‰ê·  ë“±ê¸‰: <strong>${deptInfo.avgGrade}ë“±ê¸‰</strong></p>
                    <p>â€¢ ê²½ìŸë¥ : <strong>${deptInfo.competition}:1</strong></p>
                    <p>â€¢ ìµœì € ì ìˆ˜: <strong>${deptInfo.minScore}ì </strong></p>
                </div>
                
                <div style="margin: 20px 0;">
                    <h4>ğŸ“š í•„ìš” í•™ìŠµëŸ‰</h4>
                    <p>â€¢ ì´ í•™ìŠµ ì‹œê°„: <strong>${studyHours.total}ì‹œê°„</strong></p>
                    <p>â€¢ ì¼ì¼ í•™ìŠµ ì‹œê°„: <strong>${studyHours.daily}ì‹œê°„</strong></p>
                    <p>â€¢ ì£¼ê°„ í•™ìŠµ ì‹œê°„: <strong>${studyHours.weekly}ì‹œê°„</strong></p>
                </div>
                
                <div style="margin: 20px 0;">
                    <h4>ğŸ“… ê³¼ëª©ë³„ í•™ìŠµ ê³„íš</h4>
                    <div class="study-plan">
                        <strong>ìˆ˜í•™ (${studyHours.subjects.math}ì‹œê°„/ì£¼)</strong>
                        <p>â€¢ ê°œë… ì •ë¦¬: 2ì‹œê°„/ì¼</p>
                        <p>â€¢ ë¬¸ì œ í’€ì´: 3ì‹œê°„/ì¼</p>
                        <p>â€¢ ì˜¤ë‹µ ì •ë¦¬: 1ì‹œê°„/ì¼</p>
                    </div>
                    <div class="study-plan">
                        <strong>ì˜ì–´ (${studyHours.subjects.english}ì‹œê°„/ì£¼)</strong>
                        <p>â€¢ ë‹¨ì–´ ì•”ê¸°: 1ì‹œê°„/ì¼</p>
                        <p>â€¢ ë…í•´ ì—°ìŠµ: 2ì‹œê°„/ì¼</p>
                        <p>â€¢ ë“£ê¸° ì—°ìŠµ: 30ë¶„/ì¼</p>
                    </div>
                    <div class="study-plan">
                        <strong>êµ­ì–´ (${studyHours.subjects.korean}ì‹œê°„/ì£¼)</strong>
                        <p>â€¢ ë¬¸í•™ ë¶„ì„: 1.5ì‹œê°„/ì¼</p>
                        <p>â€¢ ë¹„ë¬¸í•™ ë…í•´: 2ì‹œê°„/ì¼</p>
                        <p>â€¢ ë¬¸ë²• ì •ë¦¬: 30ë¶„/ì¼</p>
                    </div>
                </div>
                
                <div style="margin: 20px 0; padding: 15px; background: #e6f7ff; border-radius: 8px;">
                    <h4>ğŸ¤– AI ì¶”ì²œì‚¬í•­</h4>
                    <p>â€¢ í˜„ì¬ ë“±ê¸‰ 3ë“±ê¸‰ ê¸°ì¤€, ${deptInfo.avgGrade}ë“±ê¸‰ ë„ë‹¬ê¹Œì§€ <strong>${Math.ceil(studyHours.total/100)*100}ì‹œê°„</strong> í•„ìš”</p>
                    <p>â€¢ ë§¤ì¼ <strong>ìµœì†Œ ${studyHours.daily}ì‹œê°„</strong> í•™ìŠµ í•„ìˆ˜</p>
                    <p>â€¢ ì£¼ë§ ë³´ì¶© í•™ìŠµ <strong>ê¶Œì¥</strong></p>
                    <p>â€¢ ëª¨ì˜ê³ ì‚¬ <strong>ì›” 2íšŒ</strong> í•„ìˆ˜ ì‘ì‹œ</p>
                </div>
            `;
            
            resultDiv.classList.remove('hidden');
        }
        
        function calculateStudyHours(targetGrade, days) {
            const currentGrade = 3; // ê¸°ë³¸ê°’
            const gradeGap = currentGrade - targetGrade;
            const baseHours = gradeGap * 500; // ë“±ê¸‰ë‹¹ 500ì‹œê°„
            
            return {
                total: baseHours,
                daily: Math.round(baseHours / days * 10) / 10,
                weekly: Math.round(baseHours / days * 7 * 10) / 10,
                subjects: {
                    math: Math.round(baseHours * 0.35 / days * 7 * 10) / 10,
                    english: Math.round(baseHours * 0.25 / days * 7 * 10) / 10,
                    korean: Math.round(baseHours * 0.25 / days * 7 * 10) / 10,
                    science: Math.round(baseHours * 0.15 / days * 7 * 10) / 10
                }
            };
        }
        
        function recommendUniversities() {
            const grades = {
                korean: parseInt(document.getElementById('grade-korean').value),
                math: parseInt(document.getElementById('grade-math').value),
                english: parseInt(document.getElementById('grade-english').value),
                science1: parseInt(document.getElementById('grade-science1').value),
                science2: parseInt(document.getElementById('grade-science2').value)
            };
            
            const avgGrade = Object.values(grades).reduce((a, b) => a + b, 0) / 5;
            const resultDiv = document.getElementById('currentResult');
            
            // ì§„í•™ ê°€ëŠ¥ ëŒ€í•™ ì°¾ê¸°
            const recommendations = [];
            
            for (const [univName, univData] of Object.entries(universityDB)) {
                for (const [deptName, deptData] of Object.entries(univData.departments)) {
                    if (avgGrade <= deptData.avgGrade + 0.5) {
                        recommendations.push({
                            university: univName,
                            department: deptName,
                            avgGrade: deptData.avgGrade,
                            competition: deptData.competition,
                            probability: calculateProbability(avgGrade, deptData.avgGrade)
                        });
                    }
                }
            }
            
            // í•©ê²© í™•ë¥  ìˆœìœ¼ë¡œ ì •ë ¬
            recommendations.sort((a, b) => b.probability - a.probability);
            
            let html = `
                <h3>ğŸ“ ì§„í•™ ê°€ëŠ¥ ëŒ€í•™ ì¶”ì²œ</h3>
                <p style="margin: 10px 0;">í˜„ì¬ í‰ê·  ë“±ê¸‰: <strong>${avgGrade.toFixed(1)}ë“±ê¸‰</strong></p>
                
                <h4 style="margin-top: 20px;">ğŸ“Š ì¶”ì²œ ëŒ€í•™ (ìƒìœ„ 10ê°œ)</h4>
            `;
            
            recommendations.slice(0, 10).forEach(rec => {
                html += `
                    <div class="university-recommendation">
                        <strong>${rec.university} ${rec.department}</strong>
                        <p>â€¢ í•©ê²© ê°€ëŠ¥ì„±: <strong>${rec.probability}%</strong></p>
                        <p>â€¢ í‰ê·  ë“±ê¸‰: ${rec.avgGrade}ë“±ê¸‰</p>
                        <p>â€¢ ê²½ìŸë¥ : ${rec.competition}:1</p>
                    </div>
                `;
            });
            
            html += `
                <div style="margin-top: 30px;">
                    <h4>ğŸ“š ë§ì¶¤ í•™ìŠµ ì „ëµ</h4>
                    <div class="study-plan">
                        <strong>ë‹¨ê¸° ëª©í‘œ (3ê°œì›”)</strong>
                        <p>â€¢ í˜„ì¬ ${avgGrade.toFixed(1)}ë“±ê¸‰ â†’ ${(avgGrade - 0.5).toFixed(1)}ë“±ê¸‰</p>
                        <p>â€¢ ì¼ì¼ í•™ìŠµ: 8ì‹œê°„</p>
                        <p>â€¢ ì£¼ê°„ ëª¨ì˜ê³ ì‚¬: 2íšŒ</p>
                    </div>
                    <div class="study-plan">
                        <strong>ì¤‘ê¸° ëª©í‘œ (6ê°œì›”)</strong>
                        <p>â€¢ ëª©í‘œ: ${(avgGrade - 1).toFixed(1)}ë“±ê¸‰ ë‹¬ì„±</p>
                        <p>â€¢ ì¼ì¼ í•™ìŠµ: 10ì‹œê°„</p>
                        <p>â€¢ ì•½ì  ê³¼ëª© ì§‘ì¤‘ ë³´ê°•</p>
                    </div>
                </div>
            `;
            
            resultDiv.innerHTML = html;
            resultDiv.classList.remove('hidden');
        }
        
        function calculateProbability(currentGrade, requiredGrade) {
            const gap = requiredGrade - currentGrade;
            if (gap >= 0) return 95;
            if (gap >= -0.5) return 80;
            if (gap >= -1) return 60;
            if (gap >= -1.5) return 40;
            return 20;
        }
        
        // =====================================================
        // PWA Service Worker Registration
        // =====================================================
        
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            });
        }
        
        // =====================================================
        // Initialization
        // =====================================================
        
        window.onload = function() {
            console.log('StudyLens AI - ìŠ¤ë§ˆíŠ¸ êµê³¼ì„œ ì¸ì‹ ì‹œìŠ¤í…œ ì¤€ë¹„ ì™„ë£Œ');
            console.log('Version: 1.0.0');
            
            // Draw sample chart
            const canvas = document.getElementById('weeklyChart');
            if (canvas && canvas.getContext) {
                const ctx = canvas.getContext('2d');
                
                const data = [6, 7, 8, 6, 9, 8, 7];
                const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'];
                
                const barWidth = 40;
                const barGap = 20;
                const startX = 50;
                const startY = 150;
                const maxHeight = 100;
                
                ctx.fillStyle = '#4c51bf';
                data.forEach((value, index) => {
                    const height = (value / 10) * maxHeight;
                    ctx.fillRect(
                        startX + index * (barWidth + barGap),
                        startY - height,
                        barWidth,
                        height
                    );
                    
                    ctx.fillStyle = '#333';
                    ctx.font = '12px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(
                        days[index],
                        startX + index * (barWidth + barGap) + barWidth / 2,
                        startY + 20
                    );
                    ctx.fillText(
                        value + 'h',
                        startX + index * (barWidth + barGap) + barWidth / 2,
                        startY - height - 10
                    );
                    
                    ctx.fillStyle = '#4c51bf';
                });
            }
        };
    </script>
</body>
</html>
